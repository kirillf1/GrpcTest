# Прототип авторизации
## Основные проекты
1. Core- хранятся основные сущности для демонстрации прототипа
2. GrpcService - сервер для выдачи данных и контроля JWT токенов
3. UI - проект для тестирования контроля доступа, подключен к Grpc сервису( изменить адрес подключения можно в конструкторе [MainWindow](/UI/MainWindow.axaml.cs)

## JWT
Для авторизации используется JWT. Если кратко, то это зашифрованная информация необходимая для общения между клиентом и сервером, этот токен в нашем случае хранит
имя пользователя и роль. Более подробно про Claims и роли можно [тут](https://dev.to/moe23/asp-net-core-rest-api-authorization-with-jwt-roles-vs-claims-vs-policy-step-by-step-5bgn)
,а про JWT [тут](https://www.rfc-editor.org/rfc/rfc7519)
Чтобы токен выдался необходимо в UI части пройти регистрацию. Регистрация состоит из указания имени, пароли и роли. После регистрации пользователь добавится в хранилище

## Роли
Для демонстрации я использовал три типа ролей: 
1. Admin - данная роль позволяет просматривать контент, редактировать пользователей и просматривать данные
2. User - роль позволяет лишь просматривать данные, редактирование запрещено
3. Unknown - роль которая вообще ничего не может == незареганому юзеру

Роль состоит из разрешений. Разрешения могут быть разными,например, в примере реализовано разрешение CanEdit и СanWatch. Также существуют разрешения
на данные. Например в прототипе реализовано, что пользователь получает свои данные, админ свои, а unknown никакие

## Как это просходит технически
1.В UI части пользователь регистрируется и выбирает роль и отрпавляет на сервер
2. Сервер создает пользователя и если все в норме, то выдает JWT токен с Claims: имя и роль, при этом шифрует кусок специальным секретным значением
3. Сервер отправляет пользователю JWT токен и пользователь сохраняет его
4. Далее пользователь выполняет различные операции, если происходит запрос на сервер, то этот токен отправляется на сервер и там проверяется валидность токена
то есть в JWT есть зашифрованная часть с секретом, если он ее расшифровывает, то все ок, если нет, то пользователь в контексте запрооса не создается, что не позволит получить
секретные данные. Поэтому токен подделать невозможно
